{{- if .Values.backup.enabled }}
apiVersion: postgresql.cnpg.io/v1
kind: ScheduledBackup
metadata:
  name: {{ .Release.Name }}-scheduled-backup
  namespace: {{ .Release.Namespace }}
spec:
  schedule: "{{ .Values.backup.scheduleCron }}"
  backupOwnerReference: self
  method: plugin
  cluster:
    name: {{ .Release.Name }}
  pluginConfiguration:
    name: barman-cloud.cloudnative-pg.io
{{- end }}
